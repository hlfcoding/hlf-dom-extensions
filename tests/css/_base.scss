/*
  Base Visual Test
  ================
  Provides the styling foundation for visual test pages. Import into a test
  stylesheet.
*/

// Variables
// ---------
$shade-color: #000 !default;
$light-color: #fff !default;

$bg-color: #dadad6 !default;
$fill-color: rgba($light-color, .95) !default;
$line-color: rgba($shade-color, .1) !default;
$accent-color: #06d;

$line-size: 3px;
$radius-size: 10px;
$rem: 14px; // Until we drop IE 8, rem can't replace this.

// Placeholders
// ------------

%clearfix {
  &::before,
  &::after {
    content: ' ';
    display: table;
  }

  &::after { clear: both; }
}

%dimmed {
  opacity: .5;

  &:hover,
  &:focus { opacity: 1; }
}

%panel-skin {
  background: {
    color: $fill-color;
    clip: padding-box;
  }
  border: $line-size solid $line-color;
  box: {
    shadow: (
      inset 0 0 0 1px rgba($light-color, .7),
      inset 0 0 $rem rgba($shade-color, .05)
    );
    sizing: border-box;
  }

  &:hover {
    background-color: opacify($fill-color, .1);
  }
}

%pull-left-right {
  margin: { left: -$rem; right: -$rem; }
  padding: { left: $rem; right: $rem; }
}

// Base CSS Output
// ---------------

html {
  font-size: $rem;
}

body {
  background-color: $bg-color;
  font-family: Helvetica, sans-serif;
  padding: $rem;
  padding-top: 0;
}

a {
  color: $accent-color;
  text-decoration: none;

  &:hover {
    color: saturate(lighten($accent-color, 10%), 10%);
    text-decoration: underline;
  }
}

button {
  background: {
    clip: padding-box;
    color: lighten($bg-color, 10%);
  }
  border: 1px solid rgba($shade-color, .5);
  padding: .3em .6em;

  &:focus {
    outline: none;
    box-shadow: 0 0 0 .3em rgba($shade-color, .1);
  }
}

body > header { /* test page header */
  $header-bg-color: darken($bg-color, 70%);
  $header-fg-color: mix($header-bg-color, invert($header-bg-color), 30%);
  @extend %pull-left-right;
  background: $header-bg-color;
  box-shadow: inset 0 30px 40px -20px rgba($shade-color, .4);
  color: $header-fg-color;
  text-shadow: 0 1px rgba($shade-color, .7);

  > * {
    display: inline-block;

    &:not(:first-child) {
      @extend %dimmed;
      margin-left: $rem;
    }
  }

  > h1 {
    /* reset */
    font-weight: normal;
    margin: 0;
  }

  > fieldset {
    border: {
      color: lighten($header-bg-color, 20%);
      radius: $radius-size;
    }
    padding: 0 10px 10px;

    > legend {
      opacity: .5;
      padding: .2 * $rem;
    }

    > label + label {
      margin-left: $rem / 2;
    }
  }
}

h1 { /* test page title */
  font-size: 1.5 * $rem;
  letter-spacing: -1px;
  padding: { bottom: $rem; top: 4 * $rem; }
}

#main { /* non-edge tests container */
  padding: $rem 0 (2 * $rem);
}

p { /* common test content container */
  padding: $rem 0;
}

section.visual-test { /* main test styles */
  $box-shadow: (
    inset 0 1px 4px rgba($shade-color, .3),
    0 1px 0 rgba($light-color, .3)
  );

  &:not(:last-child) {
    padding-bottom: $rem;
  }

  header {
    $header-bg-color: darken($bg-color, 10%);
    $header-fg-color: mix($header-bg-color, invert($header-bg-color), 10%);
    @extend %clearfix, %pull-left-right;
    background: $header-bg-color;
    box-shadow: $box-shadow;
    color: $header-fg-color;
    font-weight: bold;
    padding: { bottom: $rem / 2; top: $rem; }
    text-shadow: 0 1px $bg-color;

    > .label::after { content: ':'; }

    > [data-rel=docs] {
      @extend %dimmed;
      float: right;
      font-weight: normal;
    }
  }

  footer:not(:empty) {
    background: darken($bg-color, 5%);
    border-radius: $radius-size;
    box-shadow: $box-shadow;
    margin-bottom: $rem;
    padding: $rem / 2;

    > * { @extend %dimmed; }

    > button {
      border-radius: 4px;
      font-size: .9em;
    }
  }
}

.edge { /* alternative test container styles */
  position: absolute;

  &.affixed { position: fixed; }
  &.top { top: $rem; }
  &.right { right: $rem; }
  &.bottom { bottom: $rem; }
  &.left { left: $rem; }
}

.edge-call {
  &:not(body) {
    position: relative;
  }

  > .visual-test-fragment {
    @extend .edge, %panel-skin;
    border-radius: $radius-size;
    padding: $rem;
  }
}

// Other CSS Output
// ----------------

.box {
  @extend %panel-skin;
  border-radius: $radius-size;
  margin: $rem 0;
  padding: $rem;
}

.list-item {
  @extend %panel-skin;
  border-bottom-width: 0;
  display: block;
  padding: $rem;
}

.list-item-first {
  border-top: {
    left-radius: $radius-size;
    right-radius: $radius-size;
  }
}

.list-item-last {
  border-bottom: {
    left-radius: $radius-size;
    right-radius: $radius-size;
    width: $line-size;
  }
}

.list {
  list-style: none;
  margin: $rem 0;
  padding: 0;

  .item {
    width: 300px;
    @extend .list-item;
  }

  > a,
  li.no-a {
    @extend .item;
    &:first-child { @extend .list-item-first; }
    &:last-child { @extend .list-item-last; }
  }

  li:not(.no-a) {
    > a { @extend .item; }
    &:first-child > a { @extend .list-item-first; }
    &:last-child > a { @extend .list-item-last; }
  }
}

.bar-item {
  @extend %panel-skin;
  border-right-width: 0;
  display: block;
  float: left;
  padding: $rem;
}
.bar-item-first {
  border: {
    top-left-radius: $radius-size;
    bottom-left-radius: $radius-size;
  }
}
.bar-item-last {
  border: {
    top-right-radius: $radius-size;
    bottom-right-radius: $radius-size;
    width: $line-size;
  }
}
.bar {
  @extend %clearfix;
  margin: $rem 0;

  .item { @extend .bar-item; }

  > a,
  li.no-a {
    @extend .item;
    &:first-child { @extend .bar-item-first; }
    &:last-child { @extend .bar-item-last; }
  }

  li:not(.no-a) {
    > a { @extend .item; }
    &:first-child > a { @extend .bar-item-first; }
    &:last-child > a { @extend .bar-item-last; }
  }
}

.grid-item {
  float: left;
  line-height: 0;
  margin: { bottom: $rem / 2; right: $rem / 2; }
}
.grid {
  @extend %clearfix;
  list-style: none;
  padding-left: 0;
  width: 350px;

  li { @extend .grid-item; }
}
