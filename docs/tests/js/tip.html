<!DOCTYPE html><html lang="en"><head><title>tests/js/tip</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../"><meta name="groc-document-path" content="tests/js/tip"><meta name="groc-project-path" content="tests/js/tip.coffee"><link rel="stylesheet" type="text/css" media="all" href="../../assets/style.css"><script type="text/javascript" src="../../assets/behavior.js"></script><body><div id="meta"><div class="file-path">tests/js/tip.coffee</div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><h1 id="hlf-tip-visual-tests">HLF Tip Visual Tests</h1></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><a href="../../../tests/tip.visual.html">Page</a> | <a href="../../src/js/jquery.hlf.tip.html">Source</a></p></div></div><div class="code"><div class="wrapper"><span class="hljs-built_in">require</span>.config
  <span class="hljs-attribute">baseUrl</span>: <span class="hljs-string">'../lib'</span>
  <span class="hljs-attribute">paths</span>:
    <span class="hljs-attribute">hlf</span>: <span class="hljs-string">'../dist'</span>
    <span class="hljs-attribute">test</span>: <span class="hljs-string">'../tests/js'</span>
  <span class="hljs-attribute">shim</span>:
    <span class="hljs-attribute">TweenLite</span>:
      <span class="hljs-attribute">exports</span>: <span class="hljs-string">'TweenLite'</span>
    <span class="hljs-string">'jquery.gsap'</span>:
      <span class="hljs-attribute">deps</span>: [<span class="hljs-string">'jquery'</span>, <span class="hljs-string">'CSSPlugin'</span>, <span class="hljs-string">'TweenLite'</span>]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>For performant animations, <strong>custom animators</strong> can be used. The below are
examples of requiring GSAP and Velocity. Note Velocity does not provide a
Promise shim and is annoyingly na√Øve, so we must do it ourselves. See
<a href="http://julian.com/research/velocity/#promises">http://julian.com/research/velocity/#promises</a></p></div></div><div class="code"><div class="wrapper">animatorName = location.search.match(<span class="hljs-regexp">/\banimator=(\w+)\b/</span>)?[<span class="hljs-number">1</span>]
animatorName ?= <span class="hljs-string">'jquery'</span>
animatorDeps = <span class="hljs-keyword">switch</span> animatorName
  <span class="hljs-keyword">when</span> <span class="hljs-string">'gsap'</span> <span class="hljs-keyword">then</span> [<span class="hljs-string">'jquery.gsap'</span>]
  <span class="hljs-keyword">when</span> <span class="hljs-string">'jquery'</span> <span class="hljs-keyword">then</span> []
  <span class="hljs-keyword">when</span> <span class="hljs-string">'velocity'</span> <span class="hljs-keyword">then</span> [<span class="hljs-string">'promise'</span>, <span class="hljs-string">'velocity'</span>]

<span class="hljs-built_in">require</span> [
  <span class="hljs-string">'jquery'</span>
  <span class="hljs-string">'underscore'</span>
].concat(animatorDeps, [
  <span class="hljs-string">'test/base-visual'</span>
  <span class="hljs-string">'hlf/jquery.hlf.tip'</span>
]), <span class="hljs-function"><span class="hljs-params">($, _)</span> -&gt;</span>
  <span class="hljs-string">'use strict'</span>

  <span class="hljs-keyword">return</span> <span class="hljs-literal">no</span> <span class="hljs-keyword">if</span> <span class="hljs-built_in">window</span>.QUnit?</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Setup visual tests. Tests are decorated closures queued and run on document-
ready. Tip specific setup:</p>
<ol>
<li>Some basic input binding for custom animator.</li>
<li>To get back promises, Velocity&#39;s API actually requires additional work by
not directly correlating with jQuery&#39;s.</li>
</ol>
<p>Note that the sample logic in tests is in JavaScript (perhaps easier to
understand than CoffeeScript) for your convenience.</p></div></div><div class="code"><div class="wrapper">  tests = []

  $(<span class="hljs-string">'.animator :radio'</span>).prop <span class="hljs-string">'checked'</span>, <span class="hljs-literal">no</span>
    .filter(<span class="hljs-string">"[value=<span class="hljs-subst">#{animatorName}</span>]"</span>).prop <span class="hljs-string">'checked'</span>, <span class="hljs-literal">yes</span>
    .end().click -&gt; location.search = <span class="hljs-string">"?animator=<span class="hljs-subst">#{$(@).val()}</span>"</span>; <span class="hljs-keyword">return</span>

  <span class="hljs-keyword">if</span> animatorName <span class="hljs-keyword">is</span> <span class="hljs-string">'velocity'</span>
    `<span class="javascript">animator = {
      show: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($el, options)</span> </span>{
        $.Velocity(<span class="hljs-string">'fadeIn'</span>, options).then(options.done, options.fail);
      },
      hide: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($el, options)</span> </span>{
        $.Velocity(<span class="hljs-string">'fadeOut'</span>, options).then(options.done, options.fail);
      }
    };</span>`</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="default">Default</h2>
<p>Basic test with the default settings. Basic tooltips are created and
accessed via <code>$.fn.tip</code>. Tip should entirely follow mouse. Tip size should
change when switching between links.</p>
<p>Note: currently, the tip only parses content from the <code>title</code> and <code>alt</code>
attributes. This is limiting, but also conventional and easier to
maintain than a custom attribute.</p>
<p>Note: <code>$context</code> also needs to be passed in. This is the core plugin
generator&#39;s convention where if the plugin instance is to be attached to
something besides the element(s) calling the method, it must be passed
in after the first argument (options or command).</p></div></div><div class="code"><div class="wrapper">  tests.push $.visualTest

    <span class="hljs-attribute">label</span>: <span class="hljs-string">'by default'</span>
    <span class="hljs-attribute">template</span>:
      <span class="hljs-string">"""
      &lt;p&gt;
        &lt;a class="trigger" title="link details" href="javascript:"&gt;tooltip trigger&lt;/a&gt; &amp;middot;
        &lt;a class="trigger" title="&lt;%= loremIpsum.short %&gt;" href="javascript:"&gt;tooltip trigger&lt;/a&gt; &amp;middot;
        &lt;a class="trigger" title="&lt;%= loremIpsum.long %&gt;" href="javascript:"&gt;tooltip trigger&lt;/a&gt;
      &lt;/p&gt;
      """</span>
    <span class="hljs-attribute">test</span>: <span class="hljs-function"><span class="hljs-params">($context)</span> -&gt;</span>
      `<span class="javascript">$context.find(<span class="hljs-string">'[title]'</span>).tip(<span class="hljs-literal">null</span>, $context);</span>`
      `<span class="javascript"><span class="hljs-keyword">var</span> api = $context.tip(<span class="hljs-literal">null</span>, $context);</span>`
      <span class="hljs-keyword">return</span>

    <span class="hljs-attribute">anchorName</span>: <span class="hljs-string">'default'</span>
    <span class="hljs-attribute">className</span>: <span class="hljs-string">'default-call'</span>
    <span class="hljs-attribute">vars</span>: _.pick $, <span class="hljs-string">'loremIpsum'</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="snapping-vertically">Snapping Vertically</h2>
<p>Snapping tooltips are created and accessed via <code>$.fn.snapTip</code>. Options
related to snapping are in the <code>snap</code> option group. This one should snap to
an appropriate x position, along the trigger&#39;s most fitting edge (left or
right). In this case it should snap to the right and only be able to follow
the mouse along the y-axis.</p></div></div><div class="code"><div class="wrapper">  tests.push $.visualTest

    <span class="hljs-attribute">label</span>: <span class="hljs-string">'snapping with a list'</span>
    <span class="hljs-attribute">template</span>:
      <span class="hljs-string">"""
      &lt;ul class="list"&gt;
      &lt;% _.range(1, count +1).forEach(function(i) { %&gt;
        &lt;li&gt;
          &lt;a class="trigger" title="This is list item &lt;%= i %&gt; in detail." href="javascript:"&gt;
            tooltip trigger
          &lt;/a&gt;
        &lt;/li&gt;
      &lt;% }); %&gt;
      &lt;/ul&gt;
      """</span>
    <span class="hljs-attribute">footerHtml</span>:
      <span class="hljs-string">"""
      &lt;button name="list-append"&gt;load more&lt;/button&gt;
      """</span>
    <span class="hljs-attribute">test</span>: <span class="hljs-function"><span class="hljs-params">($context)</span> -&gt;</span>
      `<span class="javascript">$context.find(<span class="hljs-string">'[title]'</span>).snapTip({ snap: { toYAxis: <span class="hljs-literal">true</span> } }, $context);</span>`
      <span class="hljs-keyword">return</span>

    <span class="hljs-attribute">anchorName</span>: <span class="hljs-string">'snapping-vertically'</span>
    <span class="hljs-attribute">className</span>: <span class="hljs-string">'list-call'</span>
    <span class="hljs-attribute">vars</span>: { <span class="hljs-attribute">count</span>: <span class="hljs-number">3</span> }
    <span class="hljs-attribute">beforeTest</span>: <span class="hljs-function"><span class="hljs-params">($context)</span> -&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Minor logic to make titles dynamic.</p></div></div><div class="code"><div class="wrapper">      $.visualTest.setupAppendButton $context, <span class="hljs-string">'.list'</span>, <span class="hljs-function"><span class="hljs-params">($newItem)</span> -&gt;</span>
        $trigger = $newItem.find <span class="hljs-string">'[title]'</span>
        title = $trigger.attr(<span class="hljs-string">'title'</span>).replace <span class="hljs-regexp">/\d/</span>, $newItem.index() + <span class="hljs-number">1</span>
        $trigger.attr <span class="hljs-string">'title'</span>, title
      <span class="hljs-keyword">return</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="snapping-horizontally">Snapping Horizontally</h2>
<p>Change the flag from <code>toYAxis</code> to <code>toXAxis</code>, and this one should snap to
an appropriate y position, along the trigger&#39;s most fitting edge (top or bottom).</p></div></div><div class="code"><div class="wrapper">  tests.push $.visualTest

    <span class="hljs-attribute">label</span>: <span class="hljs-string">'snapping with a bar'</span>
    <span class="hljs-attribute">template</span>:
      <span class="hljs-string">"""
      &lt;nav class="bar"&gt;
      &lt;% _.range(1, count +1).forEach(function(i) { %&gt;
        &lt;a class="trigger" href="#" title="This is bar item &lt;%= i %&gt; in detail."&gt;
          tooltip trigger
        &lt;/a&gt;
      &lt;% }); %&gt;
      &lt;/nav&gt;
      """</span>
    <span class="hljs-attribute">test</span>: <span class="hljs-function"><span class="hljs-params">($context)</span> -&gt;</span>
      `<span class="javascript">$context.find(<span class="hljs-string">'[title]'</span>).snapTip({ snap: { toXAxis: <span class="hljs-literal">true</span> } }, $context);</span>`
      <span class="hljs-keyword">return</span>

    <span class="hljs-attribute">anchorName</span>: <span class="hljs-string">'snapping-horizontally'</span>
    <span class="hljs-attribute">className</span>: <span class="hljs-string">'bar-call'</span>
    <span class="hljs-attribute">vars</span>: { <span class="hljs-attribute">count</span>: <span class="hljs-number">3</span> }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="a-model-use-case">A Model Use Case</h2>
<p>The above examples could suffice with Bootstrap tooltip or others. Snapping
and shifting without redundantly toggling appearance really makes a
difference when hovering over a grid of small individual content pieces, ie.
avatar images.</p></div></div><div class="code"><div class="wrapper">  tests.push $.visualTest

    <span class="hljs-attribute">label</span>: <span class="hljs-string">'snapping with a grid'</span>
    <span class="hljs-attribute">template</span>:
      <span class="hljs-string">"""
      &lt;ul class="grid"&gt;
      &lt;% _.range(1, count +1).forEach(function(i) { %&gt;
        &lt;li&gt;
          &lt;img src="resources/avatar.png" alt="This is avatar &lt;%= i %&gt; in detail."&gt;
        &lt;/li&gt;
      &lt;% }); %&gt;
      &lt;/ul&gt;
      """</span>
    <span class="hljs-attribute">test</span>: <span class="hljs-function"><span class="hljs-params">($context)</span> -&gt;</span>
      `<span class="javascript">$context.find(<span class="hljs-string">'[alt]'</span>).snapTip({
        snap: { toXAxis: <span class="hljs-literal">true</span> },
        animations: { hide: { delay: <span class="hljs-number">400</span> } }
      }, $context);</span>`
      <span class="hljs-keyword">return</span>

    <span class="hljs-attribute">anchorName</span>: <span class="hljs-string">'a-model-use-case'</span>
    <span class="hljs-attribute">className</span>: <span class="hljs-string">'grid-call'</span>
    <span class="hljs-attribute">vars</span>: { <span class="hljs-attribute">count</span>: <span class="hljs-number">24</span> }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="corner-cases">Corner Cases</h2>
<p>Base tips also anchor themselves to the trigger based on available space.
Here we also use snap-tip without the axis flags from before to lock the tip
into place and prevent mouse following.</p></div></div><div class="code"><div class="wrapper">  tests.push $.visualTest

    <span class="hljs-attribute">template</span>:
      <span class="hljs-string">"""
      &lt;a class="trigger top right" title="&lt;%= loremIpsum.short %&gt;" href="javascript:"&gt;
        top right corner
      &lt;/a&gt;
      &lt;a class="affixed trigger bottom left" title="&lt;%= loremIpsum.short %&gt;" href="javascript:"&gt;
        bottom left corner
      &lt;/a&gt;
      &lt;a class="affixed trigger bottom right" title="&lt;%= loremIpsum.short %&gt;" href="javascript:"&gt;
        bottom right corner
      &lt;/a&gt;
      """</span>
    <span class="hljs-attribute">test</span>: <span class="hljs-function"><span class="hljs-params">($fragments)</span> -&gt;</span>
      `<span class="javascript">$fragments.snapTip();</span>`
      <span class="hljs-keyword">return</span>

    <span class="hljs-attribute">anchorName</span>: <span class="hljs-string">'corner-cases'</span>
    <span class="hljs-attribute">asFragments</span>: <span class="hljs-literal">yes</span>
    <span class="hljs-attribute">className</span>: <span class="hljs-string">'edge-call'</span>
    <span class="hljs-attribute">vars</span>: _.pick $, <span class="hljs-string">'loremIpsum'</span>

  $ -&gt;
    test() <span class="hljs-keyword">for</span> test <span class="hljs-keyword">in</span> tests
    <span class="hljs-keyword">return</span>

  <span class="hljs-literal">yes</span></div></div></div></div></body></html>