<!doctype html>  <html> <head>   <title>jquery.hlf.tip.coffee</title>   <meta charset="utf-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>        <div id="jump_to">       Jump To &hellip;        <div id="jump_wrapper">   <form id="jump_search_wrapper" name="jump_search_form">     <input id="jump_search" name="jump_search" type="text" placeholder="Search..." tabindex="1">     <a id="clear_search" href="#" title="Clear">x</a>   </form>    <div id="jump_scroller">     <div id="jump_page">                         <a class="source" href="src.jquery.extension.hlf.core.amd.coffee.html"            title="src/jquery.extension.hlf.core.amd.coffee" data-path="src/jquery.extension.hlf.core.amd.coffee">           jquery.extension.hlf.core.amd         </a>                         <a class="source" href="index.html"            title="src/jquery.extension.hlf.core.coffee" data-path="src/jquery.extension.hlf.core.coffee">           jquery.extension.hlf.core         </a>                         <a class="source" href="src.jquery.extension.hlf.event.amd.coffee.html"            title="src/jquery.extension.hlf.event.amd.coffee" data-path="src/jquery.extension.hlf.event.amd.coffee">           jquery.extension.hlf.event.amd         </a>                         <a class="source" href="src.jquery.extension.hlf.event.coffee.html"            title="src/jquery.extension.hlf.event.coffee" data-path="src/jquery.extension.hlf.event.coffee">           jquery.extension.hlf.event         </a>                         <a class="source" href="src.jquery.hlf.tip.coffee.html"            title="src/jquery.hlf.tip.coffee" data-path="src/jquery.hlf.tip.coffee">           jquery.hlf.tip         </a>                         <a class="source" href="src.ui.canvas-app.coffee.html"            title="src/ui.canvas-app.coffee" data-path="src/ui.canvas-app.coffee">           ui.canvas-app         </a>            </div>   </div> </div>     </div>        <div id="scroller">       <table id="doc_page" cellpadding="0" cellspacing="0" data-path="src/jquery.hlf.tip.coffee">         <thead>           <tr>             <th class="docs">               <h1>                 jquery.hlf.tip.coffee               </h1>             </th>             <th class="code">             </th>           </tr>         </thead>         <tbody>                                     <tr id="section-1">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-1">&#182;</a>                 </div>                 <p>HLF Tip jQuery Plugin v2.0.1
Released under the MIT License
Written with jQuery 1.7.2</p>               </td>               <td class="code">                 <div class="highlight"><pre><span class="nv">$ = </span><span class="nx">jQuery</span>
<span class="nv">ns = </span><span class="nx">$</span><span class="p">.</span><span class="nx">hlf</span></pre></div>               </td>             </tr>                                     <tr id="section-2">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-2">&#182;</a>                 </div>                 <h1>Tooltip Plugins</h1>               </td>               <td class="code">                 <div class="highlight"><pre></pre></div>               </td>             </tr>                                     <tr id="section-3">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-3">&#182;</a>                 </div>                 <h2>Tip</h2>

<p>Basic tooltip plugin with fading. Fades in and out based on give delays. Awake
and asleep states can be read and are set after fade animations. This plugin
requires css display logic for the classes. The API class has hooks; delegation
is used instead of events due to call frequency.</p>

<p>The tip object is shared by the input jQuery collection.</p>

<p>Requires the <code>hoverIntent</code> special events, since they can be customized to
accept delays and provide pageX and pageY event properties.</p>

<p>Options:</p>

<ul>
<li><code>ms.duration</code>- Duration of sleep and wake animations.</li>
<li><code>ms.delay</code> - Delay before sleeping and waking.</li>
<li><code>cls.stem</code> - Empty to remove the stem.</li>
<li><code>cls.follow</code> - Empty to disable cursor following.</li>
<li><code>safeToggle</code> - Prevents orphan tips, since timers are sometimes unreliable.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre><span class="nv">ns.tip =</span>
  <span class="nv">debug: </span><span class="kc">off</span>
  <span class="nv">toString: </span><span class="nf">(context) -&gt;</span>
    <span class="k">switch</span> <span class="nx">context</span>
      <span class="k">when</span> <span class="s">&#39;event&#39;</span>  <span class="k">then</span> <span class="s">&#39;.hlf.tip&#39;</span>
      <span class="k">when</span> <span class="s">&#39;data&#39;</span>   <span class="k">then</span> <span class="s">&#39;hlfTip&#39;</span>
      <span class="k">when</span> <span class="s">&#39;class&#39;</span>  <span class="k">then</span> <span class="s">&#39;js-tips&#39;</span>
      <span class="k">when</span> <span class="s">&#39;log&#39;</span>    <span class="k">then</span> <span class="s">&#39;hlf-tip:&#39;</span>
      <span class="k">else</span> <span class="s">&#39;hlf.tip&#39;</span>

  <span class="nv">defaults: </span><span class="nx">do</span> <span class="nf">(pre=&#39;js-tip-&#39;) -&gt;</span>
    <span class="nv">ms:</span>
      <span class="nv">duration:</span>
        <span class="k">in</span><span class="o">:</span> <span class="mi">200</span>
        <span class="nv">out: </span><span class="mi">200</span>
      <span class="nv">delay:</span>
        <span class="k">in</span><span class="o">:</span> <span class="mi">300</span>
        <span class="nv">out: </span><span class="mi">300</span>
    <span class="nv">cursorHeight: </span><span class="mi">6</span>
    <span class="nv">defaultDirection: </span><span class="p">[</span><span class="s">&#39;south&#39;</span><span class="p">,</span> <span class="s">&#39;east&#39;</span><span class="p">]</span>
    <span class="nv">safeToggle: </span><span class="kc">on</span>
    <span class="nv">autoDirection: </span><span class="kc">on</span>
    <span class="nv">cls: </span><span class="p">(</span><span class="o">-&gt;</span>
      <span class="nv">cls = </span><span class="p">{}</span>
      <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="p">[</span><span class="s">&#39;inner&#39;</span><span class="p">,</span> <span class="s">&#39;content&#39;</span><span class="p">,</span> <span class="s">&#39;stem&#39;</span><span class="p">,</span> <span class="s">&#39;north&#39;</span><span class="p">,</span> <span class="s">&#39;east&#39;</span><span class="p">,</span> <span class="s">&#39;south&#39;</span><span class="p">,</span> <span class="s">&#39;west&#39;</span><span class="p">,</span> <span class="s">&#39;follow&#39;</span><span class="p">,</span> <span class="s">&#39;trigger&#39;</span><span class="p">],</span>
        <span class="nf">(key) -&gt;</span> <span class="nx">cls</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">pre</span><span class="si">}#{</span><span class="nx">key</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="nv">cls.tip = </span><span class="s">&#39;js-tip&#39;</span>
      <span class="k">return</span> <span class="nx">cls</span>
    <span class="p">)()</span></pre></div>               </td>             </tr>                                     <tr id="section-4">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-4">&#182;</a>                 </div>                 <h2>Snap-Tip</h2>

<p>Extends the base tip and adds snapping-to-trigger-element behavior. By default
locks into place. If one of the snap-to-axis options is turned off, the tip will
slide along the remaining locked axis.</p>

<p>The tip object is shared by the input jQuery collection.</p>

<p>Options:</p>

<ul>
<li><code>snap.xSnap</code> - Set empty to disable snapping along x-axis. Off by default.</li>
<li><code>snap.ySnap</code> - Set empty to disable snapping along y-axis. Off by default.</li>
<li><code>snap.snap</code> - Set empty to disable snapping to trigger. Builds on top of
axis-snapping. On by default.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre><span class="nv">ns.snapTip =</span>
  <span class="nv">debug: </span><span class="kc">off</span>
  <span class="nv">toString: </span><span class="nf">(context) -&gt;</span>
    <span class="k">switch</span> <span class="nx">context</span>
      <span class="k">when</span> <span class="s">&#39;event&#39;</span>  <span class="k">then</span> <span class="s">&#39;.hlf.snapTip&#39;</span>
      <span class="k">when</span> <span class="s">&#39;data&#39;</span>   <span class="k">then</span> <span class="s">&#39;hlfSnapTip&#39;</span>
      <span class="k">when</span> <span class="s">&#39;class&#39;</span>  <span class="k">then</span> <span class="s">&#39;js-snap-tips&#39;</span>
      <span class="k">when</span> <span class="s">&#39;log&#39;</span>    <span class="k">then</span> <span class="s">&#39;hlf-snap-tip:&#39;</span>
      <span class="k">else</span> <span class="s">&#39;hlf.snapTip&#39;</span>

  <span class="nv">defaults: </span><span class="nx">do</span> <span class="nf">(pre=&#39;js-snap-tip-&#39;) -&gt;</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span> <span class="kc">true</span><span class="p">,</span> <span class="p">{},</span> <span class="nx">ns</span><span class="p">.</span><span class="nx">tip</span><span class="p">.</span><span class="nx">defaults</span><span class="p">,</span>
      <span class="nv">snap:</span>
        <span class="nv">toTrigger: </span><span class="kc">on</span>
        <span class="nv">toXAxis: </span><span class="kc">off</span>
        <span class="nv">toYAxis: </span><span class="kc">off</span>
      <span class="nv">cls: </span><span class="p">(</span><span class="o">-&gt;</span>
        <span class="nv">cls =</span>
          <span class="nv">snap: </span><span class="p">{}</span>
        <span class="nx">_</span><span class="p">.</span><span class="nx">each</span>
          <span class="nv">toXAxis: </span>  <span class="s">&#39;x-side&#39;</span>
          <span class="nv">toYAxis: </span>  <span class="s">&#39;y-side&#39;</span>
          <span class="nv">toTrigger: </span><span class="s">&#39;trigger&#39;</span>
        <span class="p">,</span> <span class="nf">(val, key) -&gt;</span> <span class="nx">cls</span><span class="p">.</span><span class="nx">snap</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">pre</span><span class="si">}#{</span><span class="nx">val</span><span class="si">}</span><span class="s">&quot;</span>
        <span class="nv">cls.tip = </span><span class="s">&#39;js-tip js-snap-tip&#39;</span>
        <span class="k">return</span> <span class="nx">cls</span>
      <span class="p">)()</span></pre></div>               </td>             </tr>                                     <tr id="section-5">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-5">&#182;</a>                 </div>                 <h2>Tip API</h2>               </td>               <td class="code">                 <div class="highlight"><pre><span class="k">class</span> <span class="nx">Tip</span>

  <span class="nv">constructor: </span><span class="nf">(@$ts, @o, @$ctx) -&gt;</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">bindAll</span> <span class="nx">@</span><span class="p">,</span> <span class="s">&#39;_onTriggerMouseMove&#39;</span><span class="p">,</span> <span class="s">&#39;_setBounds&#39;</span>
    <span class="vi">@$tip = </span><span class="nx">$</span> <span class="s">&#39;&lt;div&gt;&#39;</span>
    <span class="vi">@doStem = </span><span class="nx">@o</span><span class="p">.</span><span class="nx">cls</span><span class="p">.</span><span class="nx">stem</span> <span class="o">isnt</span> <span class="s">&#39;&#39;</span>
    <span class="vi">@doFollow = </span><span class="nx">@o</span><span class="p">.</span><span class="nx">cls</span><span class="p">.</span><span class="nx">follow</span> <span class="o">isnt</span> <span class="s">&#39;&#39;</span></pre></div>               </td>             </tr>                                     <tr id="section-6">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-6">&#182;</a>                 </div>                 <ul>
<li>Toggle state: <code>awake</code>, <code>asleep</code>, <code>waking</code>, <code>sleeping</code>.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="vi">@_state = </span><span class="s">&#39;asleep&#39;</span>
    <span class="nx">@_</span><span class="nv">$tCurrent = </span><span class="kc">null</span></pre></div>               </td>             </tr>                                     <tr id="section-7">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-7">&#182;</a>                 </div>                 <ul>
<li>Process tip</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="nx">@_render</span><span class="p">()</span>
    <span class="nx">@_bind</span><span class="p">()</span></pre></div>               </td>             </tr>                                     <tr id="section-8">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-8">&#182;</a>                 </div>                 <ul>
<li>Process triggers</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="nx">@$ts</span><span class="p">.</span><span class="nx">each</span> <span class="p">(</span><span class="nx">idx</span><span class="p">,</span> <span class="nx">el</span><span class="p">)</span> <span class="o">=&gt;</span>
      <span class="nv">$t = </span><span class="nx">$</span> <span class="nx">el</span>
      <span class="nx">$t</span><span class="p">.</span><span class="nx">addClass</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">cls</span><span class="p">.</span><span class="nx">trigger</span>
      <span class="nx">@_saveTriggerContent</span> <span class="nx">$t</span>
      <span class="nx">@_bindTrigger</span> <span class="nx">$t</span>
      <span class="nx">@_updateDirectionByTrigger</span> <span class="nx">$t</span></pre></div>               </td>             </tr>                                     <tr id="section-9">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-9">&#182;</a>                 </div>                 <h3>Protected</h3>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">_defaultHtml: </span><span class="o">-&gt;</span>
    <span class="nx">do</span> <span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">@o</span><span class="p">.</span><span class="nx">cls</span><span class="p">)</span> <span class="o">=&gt;</span>
      <span class="nv">cDir = </span><span class="nx">$</span><span class="p">.</span><span class="nx">trim</span> <span class="nx">_</span><span class="p">.</span><span class="nx">reduce</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">defaultDirection</span><span class="p">,</span> <span class="p">((</span><span class="nx">cls</span><span class="p">,</span> <span class="nx">dir</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">cls</span><span class="si">}</span><span class="s"> </span><span class="si">#{</span><span class="nx">c</span><span class="p">[</span><span class="nx">dir</span><span class="p">]</span><span class="si">}</span><span class="s">&quot;</span><span class="p">),</span> <span class="s">&#39;&#39;</span>
      <span class="nv">containerClass = </span><span class="nx">$</span><span class="p">.</span><span class="nx">trim</span> <span class="p">[</span><span class="nx">c</span><span class="p">.</span><span class="nx">tip</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">follow</span><span class="p">,</span> <span class="nx">cDir</span><span class="p">].</span><span class="nx">join</span> <span class="s">&#39; &#39;</span>
      <span class="nv">stemHtml = </span><span class="s">&quot;&lt;div class=&#39;</span><span class="si">#{</span><span class="nx">c</span><span class="p">.</span><span class="nx">stem</span><span class="si">}</span><span class="s">&#39;&gt;&lt;/div&gt;&quot;</span> <span class="k">if</span> <span class="nx">@doStem</span> <span class="o">is</span> <span class="kc">on</span></pre></div>               </td>             </tr>                                     <tr id="section-10">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-10">&#182;</a>                 </div>                 <ul>
<li>Not using block strings b/c Docco 0.3.0 can't correctly parse them.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>      <span class="nv">html = </span><span class="s">&quot;&lt;div class=\&quot;</span><span class="si">#{</span><span class="nx">containerClass</span><span class="si">}</span><span class="s">\&quot;&gt;&lt;div class=\&quot;</span><span class="si">#{</span><span class="nx">c</span><span class="p">.</span><span class="nx">inner</span><span class="si">}</span><span class="s">\&quot;&gt;</span><span class="si">#{</span><span class="nx">stemHtml</span><span class="si">}</span><span class="s">&lt;div class=&#39;</span><span class="si">#{</span><span class="nx">c</span><span class="p">.</span><span class="nx">content</span><span class="si">}</span><span class="s">&#39;&gt;&quot;</span><span class="o">+</span>
             <span class="s">&quot;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&quot;</span>

  <span class="nv">_saveTriggerContent: </span><span class="nf">($t) -&gt;</span>
    <span class="nv">title = </span><span class="nx">$t</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&#39;title&#39;</span>
    <span class="k">if</span> <span class="nx">title</span> <span class="k">then</span> <span class="nx">$t</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">@_dat</span><span class="p">(</span><span class="s">&#39;Content&#39;</span><span class="p">),</span> <span class="nx">title</span><span class="p">).</span><span class="nx">removeAttr</span> <span class="s">&#39;title&#39;</span></pre></div>               </td>             </tr>                                     <tr id="section-11">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-11">&#182;</a>                 </div>                 <ul>
<li>Link the trigger to the tip for:
<ol><li>mouseenter, mouseleave (uses special events)</li>
<li>mousemove</li></ol></li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">_bindTrigger: </span><span class="nf">($t) -&gt;</span>
    <span class="nx">$t</span><span class="p">.</span><span class="kc">on</span> <span class="nx">@_evt</span><span class="p">(</span><span class="s">&#39;truemouseenter&#39;</span><span class="p">),</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="o">=&gt;</span>
      <span class="nx">@_log</span> <span class="nx">@_nsLog</span><span class="p">,</span> <span class="nx">evt</span>
      <span class="nx">@_onTriggerMouseMove</span> <span class="nx">evt</span>
    <span class="nx">$t</span><span class="p">.</span><span class="kc">on</span> <span class="nx">@_evt</span><span class="p">(</span><span class="s">&#39;truemouseleave&#39;</span><span class="p">),</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">@sleepByTrigger</span> <span class="nx">$t</span>
    <span class="k">if</span> <span class="nx">@doFollow</span> <span class="o">is</span> <span class="kc">on</span>
      <span class="nx">$t</span><span class="p">.</span><span class="kc">on</span> <span class="s">&#39;mousemove&#39;</span><span class="p">,</span> <span class="nx">@_onTriggerMouseMove</span></pre></div>               </td>             </tr>                                     <tr id="section-12">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-12">&#182;</a>                 </div>                 <ul>
<li>Bind to the tip on hover so the toggling makes an exception.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">_bind: </span><span class="nf">() -&gt;</span>
    <span class="nx">@$tip</span>
      <span class="p">.</span><span class="kc">on</span> <span class="s">&#39;mouseenter&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="o">=&gt;</span>
        <span class="nx">@_log</span> <span class="nx">@_nsLog</span><span class="p">,</span> <span class="s">&#39;enter tip&#39;</span>
        <span class="k">if</span> <span class="nx">@_$tCurrent</span><span class="o">?</span>
          <span class="nx">@_$tCurrent</span><span class="p">.</span><span class="nx">data</span> <span class="s">&#39;hlfIsActive&#39;</span><span class="p">,</span> <span class="kc">yes</span>
          <span class="nx">@wakeByTrigger</span> <span class="nx">@_$tCurrent</span>
      <span class="p">.</span><span class="kc">on</span> <span class="s">&#39;mouseleave&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="o">=&gt;</span>
        <span class="nx">@_log</span> <span class="nx">@_nsLog</span><span class="p">,</span> <span class="s">&#39;leave tip&#39;</span>
        <span class="k">if</span> <span class="nx">@_$tCurrent</span><span class="o">?</span>
          <span class="nx">@_$tCurrent</span><span class="p">.</span><span class="nx">data</span> <span class="s">&#39;hlfIsActive&#39;</span><span class="p">,</span> <span class="kc">no</span>
          <span class="nx">@sleepByTrigger</span> <span class="nx">@_$tCurrent</span></pre></div>               </td>             </tr>                                     <tr id="section-13">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-13">&#182;</a>                 </div>                 <ul>
<li>Handle adapting to window resize.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="k">if</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">autoDirection</span> <span class="o">is</span> <span class="kc">on</span>
      <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">resize</span> <span class="nx">_</span><span class="p">.</span><span class="nx">debounce</span> <span class="nx">@_setBounds</span><span class="p">,</span> <span class="mi">300</span></pre></div>               </td>             </tr>                                     <tr id="section-14">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-14">&#182;</a>                 </div>                 <ul>
<li>The tip should only need to be rendered once.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">_render: </span><span class="nf">() -&gt;</span>
    <span class="k">return</span> <span class="kc">no</span> <span class="k">if</span> <span class="nx">@$tip</span><span class="p">.</span><span class="nx">html</span><span class="p">().</span><span class="nx">length</span>
    <span class="nv">html = </span><span class="nx">@htmlOnRender</span><span class="p">()</span>
    <span class="k">if</span> <span class="o">not</span> <span class="p">(</span><span class="nx">html</span><span class="o">?</span> <span class="o">and</span> <span class="nx">html</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">then</span> <span class="nv">html = </span><span class="nx">@_defaultHtml</span><span class="p">()</span>
    <span class="vi">@$tip = </span><span class="nx">$</span><span class="p">(</span><span class="nx">html</span><span class="p">).</span><span class="nx">addClass</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">cls</span><span class="p">.</span><span class="nx">follow</span>
    <span class="nx">@$tip</span><span class="p">.</span><span class="nx">prependTo</span> <span class="nx">@$ctx</span></pre></div>               </td>             </tr>                                     <tr id="section-15">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-15">&#182;</a>                 </div>                 <ul>
<li>The tip content will change as it's being refreshed / initialized.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">_inflateByTrigger: </span><span class="nf">($t) -&gt;</span>
    <span class="nx">do</span> <span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">@o</span><span class="p">.</span><span class="nx">cls</span><span class="p">)</span> <span class="o">=&gt;</span>
      <span class="nv">dir = </span><span class="k">if</span> <span class="nx">$t</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">@_dat</span> <span class="s">&#39;Direction&#39;</span><span class="p">)</span> <span class="k">then</span> <span class="nx">$t</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">@_dat</span> <span class="s">&#39;Direction&#39;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">defaultDirection</span>
      <span class="nx">@_log</span> <span class="nx">@_nsLog</span><span class="p">,</span> <span class="s">&#39;update direction class&#39;</span><span class="p">,</span> <span class="nx">dir</span>
      <span class="nx">@$tip</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&quot;.</span><span class="si">#{</span><span class="nx">c</span><span class="p">.</span><span class="nx">content</span><span class="si">}</span><span class="s">&quot;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">$t</span><span class="p">.</span><span class="nx">data</span> <span class="nx">@_dat</span> <span class="s">&#39;Content&#39;</span><span class="p">).</span><span class="nx">end</span><span class="p">()</span>
           <span class="p">.</span><span class="nx">removeClass</span><span class="p">([</span><span class="nx">c</span><span class="p">.</span><span class="nx">north</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">south</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">east</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">west</span><span class="p">].</span><span class="nx">join</span> <span class="s">&#39; &#39;</span><span class="p">)</span>
           <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">trim</span> <span class="nx">_</span><span class="p">.</span><span class="nx">reduce</span> <span class="nx">dir</span><span class="p">,</span> <span class="p">((</span><span class="nx">cls</span><span class="p">,</span> <span class="nx">dir</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">cls</span><span class="si">}</span><span class="s"> </span><span class="si">#{</span><span class="nx">c</span><span class="p">[</span><span class="nx">dir</span><span class="p">]</span><span class="si">}</span><span class="s">&quot;</span><span class="p">),</span> <span class="s">&#39;&#39;</span><span class="p">)</span></pre></div>               </td>             </tr>                                     <tr id="section-16">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-16">&#182;</a>                 </div>                 <ul>
<li>The main toggle handler. Hooked into by <code>offsetOnTriggerMouseMove</code>.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">_onTriggerMouseMove: </span><span class="nf">(evt) -&gt;</span>
    <span class="k">return</span> <span class="kc">no</span> <span class="k">if</span> <span class="o">not</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">pageX</span><span class="o">?</span>
    <span class="nv">$t = </span><span class="k">if</span> <span class="p">(</span><span class="nv">$t = </span><span class="nx">$</span><span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">))</span> <span class="o">and</span> <span class="nx">$t</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="nx">@o</span><span class="p">.</span><span class="nx">cls</span><span class="p">.</span><span class="nx">trigger</span><span class="p">)</span> <span class="k">then</span> <span class="nx">$t</span> <span class="k">else</span> <span class="nx">$t</span><span class="p">.</span><span class="nx">closest</span><span class="p">(</span><span class="nx">@o</span><span class="p">.</span><span class="nx">cls</span><span class="p">.</span><span class="nx">trigger</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">no</span> <span class="k">if</span> <span class="o">not</span> <span class="nx">$t</span><span class="p">.</span><span class="nx">length</span>
    <span class="nx">@wakeByTrigger</span> <span class="nx">$t</span><span class="p">,</span> <span class="nx">evt</span><span class="p">,</span> <span class="o">=&gt;</span>
      <span class="nv">offset =</span>
        <span class="nv">top: </span><span class="nx">evt</span><span class="p">.</span><span class="nx">pageY</span>
        <span class="nv">left: </span><span class="nx">evt</span><span class="p">.</span><span class="nx">pageX</span>
      <span class="nv">offset = </span><span class="nx">@offsetOnTriggerMouseMove</span><span class="p">(</span><span class="nx">evt</span><span class="p">,</span> <span class="nx">offset</span><span class="p">,</span> <span class="nx">$t</span><span class="p">)</span> <span class="o">or</span> <span class="nx">offset</span>
      <span class="k">if</span> <span class="nx">@isDirection</span> <span class="s">&#39;north&#39;</span><span class="p">,</span> <span class="nx">$t</span> <span class="k">then</span> <span class="nx">offset</span><span class="p">.</span><span class="nx">top</span> <span class="o">-=</span> <span class="nx">@$tip</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">()</span> <span class="o">+</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">cursorHeight</span>
      <span class="k">if</span> <span class="nx">@isDirection</span> <span class="s">&#39;west&#39;</span><span class="p">,</span>  <span class="nx">$t</span> <span class="k">then</span> <span class="nx">offset</span><span class="p">.</span><span class="nx">left</span> <span class="o">-=</span> <span class="nx">@$tip</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">()</span>
      <span class="k">if</span> <span class="nx">@isDirection</span> <span class="s">&#39;south&#39;</span><span class="p">,</span> <span class="nx">$t</span> <span class="k">then</span> <span class="nx">offset</span><span class="p">.</span><span class="nx">top</span> <span class="o">+=</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">cursorHeight</span>
      <span class="nx">offset</span><span class="p">.</span><span class="nx">top</span> <span class="o">+=</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">cursorHeight</span>
      <span class="nx">@$tip</span><span class="p">.</span><span class="nx">css</span> <span class="nx">offset</span>
      <span class="nx">@_log</span> <span class="nx">@_nsLog</span><span class="p">,</span> <span class="s">&#39;_onTriggerMouseMove&#39;</span><span class="p">,</span> <span class="nx">@_state</span><span class="p">,</span> <span class="nx">offset</span></pre></div>               </td>             </tr>                                     <tr id="section-17">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-17">&#182;</a>                 </div>                 <ul>
<li>Auto-direction support. Given the context boundary, choose the best
direction. The data is stored with the trigger and gets accessed elsewhere.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">_updateDirectionByTrigger: </span><span class="nf">($t) -&gt;</span>
    <span class="k">return</span> <span class="kc">no</span> <span class="k">if</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">autoDirection</span> <span class="o">is</span> <span class="kc">off</span></pre></div>               </td>             </tr>                                     <tr id="section-18">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-18">&#182;</a>                 </div>                 <ul>
<li>Check if adapting is needed. Adapt and store as needed.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="nv">checkDir = </span><span class="p">(</span><span class="nx">dir</span><span class="p">)</span> <span class="o">=&gt;</span>
      <span class="k">if</span> <span class="o">not</span> <span class="nx">@_bounds</span><span class="o">?</span> <span class="k">then</span> <span class="nx">@_setBounds</span><span class="p">()</span>
      <span class="nv">ok = </span><span class="kc">yes</span>
      <span class="k">switch</span> <span class="nx">dir</span>
        <span class="k">when</span> <span class="s">&#39;south&#39;</span> <span class="k">then</span> <span class="nv">ok = </span><span class="p">(</span><span class="nv">edge = </span><span class="nx">tPosition</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="nx">tHeight</span> <span class="o">+</span> <span class="nx">size</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="o">and</span> <span class="nx">@_bounds</span><span class="p">.</span><span class="nx">bottom</span> <span class="o">&gt;</span> <span class="nx">edge</span>
        <span class="k">when</span> <span class="s">&#39;east&#39;</span>  <span class="k">then</span> <span class="nv">ok = </span><span class="p">(</span><span class="nv">edge = </span><span class="nx">tPosition</span><span class="p">.</span><span class="nx">left</span> <span class="o">+</span> <span class="nx">size</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span>  <span class="o">and</span> <span class="nx">@_bounds</span><span class="p">.</span><span class="nx">right</span> <span class="o">&gt;</span> <span class="nx">edge</span>
        <span class="k">when</span> <span class="s">&#39;north&#39;</span> <span class="k">then</span> <span class="nv">ok = </span><span class="p">(</span><span class="nv">edge = </span><span class="nx">tPosition</span><span class="p">.</span><span class="nx">top</span> <span class="o">-</span> <span class="nx">size</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="o">and</span> <span class="nx">@_bounds</span><span class="p">.</span><span class="nx">top</span> <span class="o">&lt;</span> <span class="nx">edge</span>
        <span class="k">when</span> <span class="s">&#39;west&#39;</span>  <span class="k">then</span> <span class="nv">ok = </span><span class="p">(</span><span class="nv">edge = </span><span class="nx">tPosition</span><span class="p">.</span><span class="nx">left</span> <span class="o">-</span> <span class="nx">size</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="o">and</span> <span class="nx">@_bounds</span><span class="p">.</span><span class="nx">left</span> <span class="o">&lt;</span> <span class="nx">edge</span>
      <span class="nx">@_log</span> <span class="nx">@_nsLog</span><span class="p">,</span> <span class="s">&#39;checkDir&#39;</span><span class="p">,</span> <span class="s">&quot;&#39;</span><span class="si">#{</span><span class="nx">$t</span><span class="p">.</span><span class="nx">html</span><span class="p">()</span><span class="si">}</span><span class="s">&#39;&quot;</span><span class="p">,</span> <span class="nx">dir</span><span class="p">,</span> <span class="nx">edge</span><span class="p">,</span> <span class="nx">size</span>
      <span class="k">if</span> <span class="o">not</span> <span class="nx">ok</span>
        <span class="k">switch</span> <span class="nx">dir</span>
          <span class="k">when</span> <span class="s">&#39;south&#39;</span> <span class="k">then</span> <span class="nx">newDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;north&#39;</span>
          <span class="k">when</span> <span class="s">&#39;east&#39;</span>  <span class="k">then</span> <span class="nx">newDir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;west&#39;</span>
          <span class="k">when</span> <span class="s">&#39;north&#39;</span> <span class="k">then</span> <span class="nx">newDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;south&#39;</span>
          <span class="k">when</span> <span class="s">&#39;west&#39;</span>  <span class="k">then</span> <span class="nx">newDir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;east&#39;</span>
        <span class="nx">$t</span><span class="p">.</span><span class="nx">data</span> <span class="nx">@_dat</span><span class="p">(</span><span class="s">&#39;Direction&#39;</span><span class="p">),</span> <span class="nx">newDir</span><span class="p">.</span><span class="nx">join</span> <span class="s">&#39; &#39;</span></pre></div>               </td>             </tr>                                     <tr id="section-19">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-19">&#182;</a>                 </div>                 <ul>
<li>Prepare for checking subroutine.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="nv">tPosition = </span><span class="nx">$t</span><span class="p">.</span><span class="nx">position</span><span class="p">()</span>
    <span class="nv">tWidth    = </span><span class="nx">$t</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">()</span>
    <span class="nv">tHeight   = </span><span class="nx">$t</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">()</span>
    <span class="nv">size      = </span><span class="nx">@sizeForTrigger</span> <span class="nx">$t</span>
    <span class="nv">newDir = </span><span class="nx">_</span><span class="p">.</span><span class="nx">clone</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">defaultDirection</span></pre></div>               </td>             </tr>                                     <tr id="section-20">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-20">&#182;</a>                 </div>                 <ul>
<li>Check each direction.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="nx">checkDir</span> <span class="nx">dir</span> <span class="k">for</span> <span class="nx">dir</span> <span class="k">in</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">defaultDirection</span>

  <span class="nv">_setBounds: </span><span class="o">-&gt;</span>
    <span class="nv">$ctx = </span><span class="k">if</span> <span class="nx">@$ctx</span><span class="p">.</span><span class="o">is</span><span class="p">(</span><span class="s">&#39;body&#39;</span><span class="p">)</span> <span class="k">then</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">)</span> <span class="k">else</span> <span class="nx">@$ctx</span>
    <span class="vi">@_bounds =</span>
      <span class="nv">top: </span>   <span class="nb">parseInt</span> <span class="nx">@$ctx</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s">&#39;padding-top&#39;</span><span class="p">),</span> <span class="mi">10</span>
      <span class="nv">left: </span>  <span class="nb">parseInt</span> <span class="nx">@$ctx</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s">&#39;padding-left&#39;</span><span class="p">),</span> <span class="mi">10</span>
      <span class="nv">bottom: </span><span class="nx">$ctx</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">()</span>
      <span class="nv">right: </span> <span class="nx">@$ctx</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">()</span></pre></div>               </td>             </tr>                                     <tr id="section-21">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-21">&#182;</a>                 </div>                 <h3>Public</h3>               </td>               <td class="code">                 <div class="highlight"><pre></pre></div>               </td>             </tr>                                     <tr id="section-22">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-22">&#182;</a>                 </div>                 <p>Accessors</p>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">options: </span><span class="o">-&gt;</span> <span class="nx">@o</span>
  <span class="nv">tip: </span><span class="o">-&gt;</span> <span class="nx">@$tip</span></pre></div>               </td>             </tr>                                     <tr id="section-23">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-23">&#182;</a>                 </div>                 <ul>
<li>Does a stealth render to find tip size. The data is stored with the
trigger and gets accessed elsewhere.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">sizeForTrigger: </span><span class="nf">($t, force=no) -&gt;</span></pre></div>               </td>             </tr>                                     <tr id="section-24">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-24">&#182;</a>                 </div>                 <ul>
<li>Try cached.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="nv">size =</span>
      <span class="nv">width: </span> <span class="nx">$t</span><span class="p">.</span><span class="nx">data</span> <span class="nx">@_dat</span> <span class="s">&#39;Width&#39;</span>
      <span class="nv">height: </span><span class="nx">$t</span><span class="p">.</span><span class="nx">data</span> <span class="nx">@_dat</span> <span class="s">&#39;Height&#39;</span>
    <span class="k">return</span> <span class="nx">size</span> <span class="k">if</span> <span class="nx">size</span><span class="p">.</span><span class="nx">width</span> <span class="o">and</span> <span class="nx">size</span><span class="p">.</span><span class="nx">height</span></pre></div>               </td>             </tr>                                     <tr id="section-25">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-25">&#182;</a>                 </div>                 <ul>
<li>Otherwise new.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="nx">@$tip</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&quot;.</span><span class="si">#{</span><span class="nx">@o</span><span class="p">.</span><span class="nx">cls</span><span class="p">.</span><span class="nx">content</span><span class="si">}</span><span class="s">&quot;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">$t</span><span class="p">.</span><span class="nx">data</span> <span class="nx">@_dat</span> <span class="s">&#39;Content&#39;</span><span class="p">).</span><span class="nx">end</span><span class="p">()</span>
      <span class="p">.</span><span class="nx">css</span>
        <span class="nv">display: </span><span class="s">&#39;block&#39;</span><span class="p">,</span>
        <span class="nv">visibility: </span><span class="s">&#39;hidden&#39;</span>
    <span class="nx">$t</span><span class="p">.</span><span class="nx">data</span> <span class="nx">@_dat</span><span class="p">(</span><span class="s">&#39;Width&#39;</span><span class="p">),</span>  <span class="p">(</span><span class="nv">size.width = </span><span class="nx">@$tip</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">())</span>
    <span class="nx">$t</span><span class="p">.</span><span class="nx">data</span> <span class="nx">@_dat</span><span class="p">(</span><span class="s">&#39;Height&#39;</span><span class="p">),</span> <span class="p">(</span><span class="nv">size.height = </span><span class="nx">@$tip</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">())</span>
    <span class="nx">@$tip</span><span class="p">.</span><span class="nx">css</span>
      <span class="nv">display: </span><span class="s">&#39;none&#39;</span><span class="p">,</span>
      <span class="nv">visibility: </span><span class="s">&#39;visible&#39;</span>
    <span class="nx">size</span></pre></div>               </td>             </tr>                                     <tr id="section-26">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-26">&#182;</a>                 </div>                 <ul>
<li>Direction is actually an array.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">isDirection: </span><span class="nf">(dir, $t) -&gt;</span> <span class="p">(</span><span class="nx">@$tip</span><span class="p">.</span><span class="nx">hasClass</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">cls</span><span class="p">[</span><span class="nx">dir</span><span class="p">])</span> <span class="o">or</span>
    <span class="p">((</span><span class="o">not</span> <span class="nx">$t</span><span class="o">?</span> <span class="o">or</span> <span class="o">not</span> <span class="nx">$t</span><span class="p">.</span><span class="nx">data</span> <span class="nx">@_dat</span> <span class="s">&#39;Direction&#39;</span><span class="p">)</span> <span class="o">and</span> <span class="nx">_</span><span class="p">.</span><span class="nx">include</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">defaultDirection</span><span class="p">,</span> <span class="nx">dir</span><span class="p">)</span></pre></div>               </td>             </tr>                                     <tr id="section-27">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-27">&#182;</a>                 </div>                 <p>Methods</p>               </td>               <td class="code">                 <div class="highlight"><pre></pre></div>               </td>             </tr>                                     <tr id="section-28">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-28">&#182;</a>                 </div>                 <ul>
<li>The main toggler. Takes in a callback, which is usually to update position.
The toggling and main changes only happen if the delay is passed.
<ol><li>Store current trigger info.</li>
<li>Go directly to the position updating if no toggling is needed.</li>
<li>Don't toggle if awake or waking, or if event isn't <code>truemouseenter</code>.</li>
<li>If we are in the middle of sleeping, stop and speed up our waking
transition.</li>
<li>Update our trigger cache.</li></ol></li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">wakeByTrigger: </span><span class="nf">($t, evt, cb) -&gt;</span></pre></div>               </td>             </tr>                                     <tr id="section-29">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-29">&#182;</a>                 </div>                 <ul>
<li>Check.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="nv">triggerChanged = </span><span class="o">not</span> <span class="nx">$t</span><span class="p">.</span><span class="o">is</span> <span class="nx">@_$tCurrent</span>
    <span class="k">if</span> <span class="nx">triggerChanged</span>
      <span class="nx">@_inflateByTrigger</span> <span class="nx">$t</span>
      <span class="nx">@_</span><span class="nv">$tCurrent = </span><span class="nx">$t</span></pre></div>               </td>             </tr>                                     <tr id="section-30">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-30">&#182;</a>                 </div>                 <ul>
<li>Guard.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="k">if</span> <span class="nx">@_state</span> <span class="o">is</span> <span class="s">&#39;awake&#39;</span> <span class="o">and</span> <span class="nx">cb</span><span class="o">?</span>
      <span class="nx">cb</span><span class="p">()</span>
      <span class="nx">@_log</span> <span class="nx">@_nsLog</span><span class="p">,</span> <span class="s">&#39;quick update&#39;</span>
      <span class="k">return</span> <span class="kc">yes</span>
    <span class="k">if</span> <span class="nx">evt</span><span class="o">?</span> <span class="k">then</span> <span class="nx">@_log</span> <span class="nx">@_nsLog</span><span class="p">,</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">type</span>
    <span class="k">return</span> <span class="kc">no</span> <span class="k">if</span> <span class="nx">@_state</span> <span class="k">in</span> <span class="p">[</span><span class="s">&#39;awake&#39;</span><span class="p">,</span> <span class="s">&#39;waking&#39;</span><span class="p">]</span></pre></div>               </td>             </tr>                                     <tr id="section-31">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-31">&#182;</a>                 </div>                 <ul>
<li>Prepare.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="nv">delay = </span><span class="nx">@o</span><span class="p">.</span><span class="nx">ms</span><span class="p">.</span><span class="nx">delay</span><span class="p">.</span><span class="k">in</span>
    <span class="nv">duration = </span><span class="nx">@o</span><span class="p">.</span><span class="nx">ms</span><span class="p">.</span><span class="nx">duration</span><span class="p">.</span><span class="k">in</span>
    <span class="nv">wake = </span><span class="o">=&gt;</span>
      <span class="nx">@onShow</span> <span class="nx">triggerChanged</span><span class="p">,</span> <span class="nx">evt</span>
      <span class="nx">@$tip</span><span class="p">.</span><span class="nx">fadeIn</span> <span class="nx">duration</span><span class="p">,</span> <span class="o">=&gt;</span>
        <span class="k">if</span> <span class="nx">triggerChanged</span>
          <span class="nx">cb</span><span class="p">()</span> <span class="k">if</span> <span class="nx">cb</span><span class="o">?</span>
        <span class="k">if</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">safeToggle</span> <span class="o">is</span> <span class="kc">on</span> <span class="k">then</span> <span class="nx">@$tip</span><span class="p">.</span><span class="nx">siblings</span><span class="p">(</span><span class="nx">@o</span><span class="p">.</span><span class="nx">cls</span><span class="p">.</span><span class="nx">tip</span><span class="p">).</span><span class="nx">fadeOut</span><span class="p">()</span>
        <span class="nx">@afterShow</span> <span class="nx">triggerChanged</span><span class="p">,</span> <span class="nx">evt</span>
        <span class="vi">@_state = </span><span class="s">&#39;awake&#39;</span></pre></div>               </td>             </tr>                                     <tr id="section-32">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-32">&#182;</a>                 </div>                 <ul>
<li>Run.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="k">if</span> <span class="nx">@_state</span> <span class="o">is</span> <span class="s">&#39;sleeping&#39;</span>
      <span class="nx">@_log</span> <span class="nx">@_nsLog</span><span class="p">,</span> <span class="s">&#39;clear sleep&#39;</span>
      <span class="nx">clearTimeout</span> <span class="nx">@_sleepCountdown</span>
      <span class="nv">duration = </span><span class="mi">0</span>
      <span class="nx">wake</span><span class="p">()</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">evt</span><span class="o">?</span> <span class="o">and</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">type</span> <span class="o">is</span> <span class="s">&#39;truemouseenter&#39;</span><span class="p">)</span>
      <span class="nv">triggerChanged = </span><span class="kc">yes</span>
      <span class="vi">@_state = </span><span class="s">&#39;waking&#39;</span>
      <span class="vi">@_wakeCountdown = </span><span class="nx">setTimeout</span> <span class="nx">wake</span><span class="p">,</span> <span class="nx">delay</span></pre></div>               </td>             </tr>                                     <tr id="section-33">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-33">&#182;</a>                 </div>                 <ul>
<li>Success.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="kc">yes</span></pre></div>               </td>             </tr>                                     <tr id="section-34">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-34">&#182;</a>                 </div>                 <ul>
<li>Much simpler toggler. As long as tip isn't truly visible, sleep is unneeded.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">sleepByTrigger: </span><span class="nf">($t) -&gt;</span>
    <span class="k">return</span> <span class="kc">no</span> <span class="k">if</span> <span class="nx">@_state</span> <span class="o">isnt</span> <span class="s">&#39;awake&#39;</span>
    <span class="vi">@_state = </span><span class="s">&#39;sleeping&#39;</span>
    <span class="nx">clearTimeout</span> <span class="nx">@_wakeCountdown</span>
    <span class="vi">@_sleepCountdown = </span><span class="nx">setTimeout</span> <span class="o">=&gt;</span>
      <span class="nx">@onHide</span><span class="p">()</span>
      <span class="nx">@$tip</span><span class="p">.</span><span class="nx">fadeOut</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">ms</span><span class="p">.</span><span class="nx">duration</span><span class="p">.</span><span class="nx">out</span><span class="p">,</span> <span class="o">=&gt;</span>
        <span class="vi">@_state = </span><span class="s">&#39;asleep&#39;</span>
        <span class="nx">@afterHide</span><span class="p">()</span>

    <span class="p">,</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">ms</span><span class="p">.</span><span class="nx">delay</span><span class="p">.</span><span class="nx">out</span></pre></div>               </td>             </tr>                                     <tr id="section-35">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-35">&#182;</a>                 </div>                 <ul>
<li>Success.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="kc">yes</span></pre></div>               </td>             </tr>                                     <tr id="section-36">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-36">&#182;</a>                 </div>                 <p>Hooks</p>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">onShow: </span><span class="nf">(triggerChanged, evt) -&gt;</span> <span class="k">return</span>
  <span class="nv">onHide: </span><span class="nx">$</span><span class="p">.</span><span class="nx">noop</span>
  <span class="nv">afterShow: </span><span class="nf">(triggerChanged, evt) -&gt;</span> <span class="k">return</span>
  <span class="nv">afterHide: </span><span class="nx">$</span><span class="p">.</span><span class="nx">noop</span>
  <span class="nv">htmlOnRender: </span><span class="nx">$</span><span class="p">.</span><span class="nx">noop</span>
  <span class="nv">offsetOnTriggerMouseMove: </span><span class="nf">(evt, offset, $t) -&gt;</span> <span class="kc">no</span></pre></div>               </td>             </tr>                                     <tr id="section-37">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-37">&#182;</a>                 </div>                 <h2>SnapTip API</h2>               </td>               <td class="code">                 <div class="highlight"><pre><span class="k">class</span> <span class="nx">SnapTip</span> <span class="k">extends</span> <span class="nx">Tip</span>

  <span class="nv">constructor: </span><span class="nf">($ts, o, $ctx) -&gt;</span>
    <span class="k">super</span> <span class="nx">$ts</span><span class="p">,</span> <span class="nx">o</span><span class="p">,</span> <span class="nx">$ctx</span>
    <span class="k">if</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">snap</span><span class="p">.</span><span class="nx">toTrigger</span> <span class="o">is</span> <span class="kc">off</span>
      <span class="vi">@o.snap.toTrigger = </span><span class="nx">@o</span><span class="p">.</span><span class="nx">snap</span><span class="p">.</span><span class="nx">toXAxis</span> <span class="o">is</span> <span class="kc">on</span> <span class="o">or</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">snap</span><span class="p">.</span><span class="nx">toYAxis</span> <span class="o">is</span> <span class="kc">on</span>
    <span class="k">if</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">snap</span><span class="p">.</span><span class="nx">toXAxis</span> <span class="o">is</span> <span class="kc">on</span> <span class="k">then</span> <span class="vi">@o.cursorHeight = </span><span class="mi">0</span>
    <span class="k">if</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">snap</span><span class="p">.</span><span class="nx">toYAxis</span> <span class="o">is</span> <span class="kc">on</span> <span class="k">then</span> <span class="vi">@o.cursorHeight = </span><span class="mi">2</span>
    <span class="vi">@_offsetStart = </span><span class="kc">null</span></pre></div>               </td>             </tr>                                     <tr id="section-38">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-38">&#182;</a>                 </div>                 <ul>
<li>Add snapping config as classes.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">snap</span><span class="p">,</span> <span class="p">(</span><span class="nx">active</span><span class="p">,</span> <span class="nx">prop</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">if</span> <span class="nx">active</span> <span class="k">then</span> <span class="nx">@$tip</span><span class="p">.</span><span class="nx">addClass</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">cls</span><span class="p">.</span><span class="nx">snap</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span></pre></div>               </td>             </tr>                                     <tr id="section-39">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-39">&#182;</a>                 </div>                 <h3>Protected</h3>               </td>               <td class="code">                 <div class="highlight"><pre></pre></div>               </td>             </tr>                                     <tr id="section-40">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-40">&#182;</a>                 </div>                 <ul>
<li>The main positioner. Uses the trigger offset as the base.
TODO - Still needs to support all the directions.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">_moveToTrigger: </span><span class="nf">($t, baseOffset) -&gt;</span></pre></div>               </td>             </tr>                                     <tr id="section-41">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-41">&#182;</a>                 </div>                 <p>@<em>log @</em>nsLog, baseOffset</p>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="nv">offset = </span><span class="nx">$t</span><span class="p">.</span><span class="nx">offset</span><span class="p">()</span>
    <span class="k">if</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">snap</span><span class="p">.</span><span class="nx">toXAxis</span> <span class="o">is</span> <span class="kc">on</span>
      <span class="k">if</span> <span class="nx">@isDirection</span> <span class="s">&#39;south&#39;</span> <span class="k">then</span> <span class="nx">offset</span><span class="p">.</span><span class="nx">top</span> <span class="o">+=</span> <span class="nx">$t</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">()</span>
      <span class="k">if</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">snap</span><span class="p">.</span><span class="nx">toYAxis</span> <span class="o">is</span> <span class="kc">off</span>
        <span class="nv">offset.left = </span><span class="nx">baseOffset</span><span class="p">.</span><span class="nx">left</span> <span class="o">-</span> <span class="p">(</span><span class="nx">@$tip</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">()</span> <span class="o">-</span> <span class="mi">12</span><span class="p">)</span><span class="o">/</span> <span class="mi">2</span> <span class="c1"># Note arbitrary buffer offset.</span>
    <span class="k">if</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">snap</span><span class="p">.</span><span class="nx">toYAxis</span> <span class="o">is</span> <span class="kc">on</span>
      <span class="k">if</span> <span class="nx">@isDirection</span> <span class="s">&#39;east&#39;</span> <span class="k">then</span> <span class="nx">offset</span><span class="p">.</span><span class="nx">left</span> <span class="o">+=</span> <span class="nx">$t</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">()</span>
      <span class="k">if</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">snap</span><span class="p">.</span><span class="nx">toXAxis</span> <span class="o">is</span> <span class="kc">off</span>
        <span class="nv">offset.top = </span><span class="nx">baseOffset</span><span class="p">.</span><span class="nx">top</span> <span class="o">-</span> <span class="nx">@$tip</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="nx">offset</span></pre></div>               </td>             </tr>                                     <tr id="section-42">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-42">&#182;</a>                 </div>                 <ul>
<li>Bind to get initial position for snapping. This is only for snapping
without snapping to the trigger, which is only what's currently supported.
See <code>afterShow</code> hook.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">_bindTrigger: </span><span class="nf">($t) -&gt;</span>
    <span class="k">super</span> <span class="nx">$t</span>
    <span class="nx">$t</span><span class="p">.</span><span class="kc">on</span> <span class="nx">@_evt</span><span class="p">(</span><span class="s">&#39;truemouseleave&#39;</span><span class="p">),</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="vi">@_offsetStart = </span><span class="kc">null</span></pre></div>               </td>             </tr>                                     <tr id="section-43">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-43">&#182;</a>                 </div>                 <h3>Public</h3>               </td>               <td class="code">                 <div class="highlight"><pre></pre></div>               </td>             </tr>                                     <tr id="section-44">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-44">&#182;</a>                 </div>                 <p>Hooked</p>               </td>               <td class="code">                 <div class="highlight"><pre></pre></div>               </td>             </tr>                                     <tr id="section-45">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-45">&#182;</a>                 </div>                 <ul>
<li>Make the tip invisible while it's being positioned, then reveal it.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">onShow: </span><span class="nf">(triggerChanged, evt) -&gt;</span>
    <span class="k">if</span> <span class="nx">triggerChanged</span> <span class="o">is</span> <span class="kc">yes</span>
      <span class="nx">@$tip</span><span class="p">.</span><span class="nx">css</span> <span class="s">&#39;visibility&#39;</span><span class="p">,</span> <span class="s">&#39;hidden&#39;</span>

  <span class="nv">afterShow: </span><span class="nf">(triggerChanged, evt) -&gt;</span>
    <span class="k">if</span> <span class="nx">triggerChanged</span> <span class="o">is</span> <span class="kc">yes</span>
      <span class="nx">@$tip</span><span class="p">.</span><span class="nx">css</span> <span class="s">&#39;visibility&#39;</span><span class="p">,</span> <span class="s">&#39;visible&#39;</span>
      <span class="vi">@_offsetStart =</span>
        <span class="nv">top: </span><span class="nx">evt</span><span class="p">.</span><span class="nx">pageY</span>
        <span class="nv">left: </span><span class="nx">evt</span><span class="p">.</span><span class="nx">pageX</span></pre></div>               </td>             </tr>                                     <tr id="section-46">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-46">&#182;</a>                 </div>                 <ul>
<li>Main positioning handler.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">offsetOnTriggerMouseMove: </span><span class="nf">(evt, offset, $t) -&gt;</span>
    <span class="nv">newOffset = </span><span class="nx">_</span><span class="p">.</span><span class="nx">clone</span> <span class="nx">offset</span>
    <span class="k">if</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">snap</span><span class="p">.</span><span class="nx">toTrigger</span> <span class="o">is</span> <span class="kc">on</span>
      <span class="nv">newOffset = </span><span class="nx">@_moveToTrigger</span> <span class="nx">$t</span><span class="p">,</span> <span class="nx">newOffset</span>
    <span class="k">else</span>
      <span class="k">if</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">snap</span><span class="p">.</span><span class="nx">toXAxis</span> <span class="o">is</span> <span class="kc">on</span>
        <span class="nv">newOffset.top = </span><span class="nx">@_offsetStart</span><span class="p">.</span><span class="nx">top</span>
        <span class="nx">@_log</span> <span class="nx">@_nsLog</span><span class="p">,</span> <span class="s">&#39;xSnap&#39;</span>
      <span class="k">if</span> <span class="nx">@o</span><span class="p">.</span><span class="nx">snap</span><span class="p">.</span><span class="nx">toYAxis</span> <span class="o">is</span> <span class="kc">on</span>
        <span class="nv">newOffset.left = </span><span class="nx">@_offsetStart</span><span class="p">.</span><span class="nx">left</span>
        <span class="nx">@_log</span> <span class="nx">@_nsLog</span><span class="p">,</span> <span class="s">&#39;ySnap&#39;</span>
    <span class="nx">newOffset</span></pre></div>               </td>             </tr>                                     <tr id="section-47">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-47">&#182;</a>                 </div>                 <h2>Export</h2>

<p>Both are exported with the <code>asSingleton</code> flag set to true.</p>               </td>               <td class="code">                 <div class="highlight"><pre><span class="nv">$.fn.tip = </span><span class="nx">ns</span><span class="p">.</span><span class="nx">createPlugin</span> <span class="nx">ns</span><span class="p">.</span><span class="nx">tip</span><span class="p">,</span> <span class="nx">Tip</span><span class="p">,</span> <span class="kc">yes</span>
<span class="nv">$.fn.snapTip = </span><span class="nx">ns</span><span class="p">.</span><span class="nx">createPlugin</span> <span class="nx">ns</span><span class="p">.</span><span class="nx">snapTip</span><span class="p">,</span> <span class="nx">SnapTip</span><span class="p">,</span> <span class="kc">yes</span>

</pre></div>               </td>             </tr>                    </tbody>       </table>     </div>   </div>   <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>   <script src="docco-client.js"></script>        <script>       docco = window.docco || {};       docco.no_results_tpl = function(vars){         vars.msg = vars.msg || 'No results.';         return '<div class="menu-item no-results">'+vars.msg+'</div>';        };       docco.sticky_item_tpl = function(vars){         if (!vars.path || !vars.href) { return; }         return '<a class="source sticky" href="'+vars.href+'"'+             'title="'+vars.path+'" data-path="'+vars.path+'">'+             vars.path.split('/').pop().split('.').shift()+             '<span class="remove" title="Remove sticky">x</span>'+           '</a>';       };     </script>    </body> </html> 