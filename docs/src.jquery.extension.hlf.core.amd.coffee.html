<!doctype html>  <html> <head>   <title>jquery.extension.hlf.core.amd.coffee</title>   <meta charset="utf-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>        <div id="jump_to">       Jump To &hellip;        <div id="jump_wrapper">   <form id="jump_search_wrapper" name="jump_search_form">     <input id="jump_search" name="jump_search" type="text" placeholder="Search..." tabindex="1">     <a id="clear_search" href="#" title="Clear">x</a>   </form>    <div id="jump_scroller">     <div id="jump_page">                         <a class="source" href="src.jquery.extension.hlf.core.amd.coffee.html"            title="src/jquery.extension.hlf.core.amd.coffee" data-path="src/jquery.extension.hlf.core.amd.coffee">           jquery.extension.hlf.core.amd         </a>                         <a class="source" href="index.html"            title="src/jquery.extension.hlf.core.coffee" data-path="src/jquery.extension.hlf.core.coffee">           jquery.extension.hlf.core         </a>                         <a class="source" href="src.jquery.extension.hlf.event.amd.coffee.html"            title="src/jquery.extension.hlf.event.amd.coffee" data-path="src/jquery.extension.hlf.event.amd.coffee">           jquery.extension.hlf.event.amd         </a>                         <a class="source" href="src.jquery.extension.hlf.event.coffee.html"            title="src/jquery.extension.hlf.event.coffee" data-path="src/jquery.extension.hlf.event.coffee">           jquery.extension.hlf.event         </a>                         <a class="source" href="src.jquery.hlf.tip.coffee.html"            title="src/jquery.hlf.tip.coffee" data-path="src/jquery.hlf.tip.coffee">           jquery.hlf.tip         </a>                         <a class="source" href="src.ui.canvas-app.coffee.html"            title="src/ui.canvas-app.coffee" data-path="src/ui.canvas-app.coffee">           ui.canvas-app         </a>            </div>   </div> </div>     </div>        <div id="scroller">       <table id="doc_page" cellpadding="0" cellspacing="0" data-path="src/jquery.extension.hlf.core.amd.coffee">         <thead>           <tr>             <th class="docs">               <h1>                 jquery.extension.hlf.core.amd.coffee               </h1>             </th>             <th class="code">             </th>           </tr>         </thead>         <tbody>                                     <tr id="section-1">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-1">&#182;</a>                 </div>                 <p>HLF Core jQuery Extension v1.0
Released under the MIT License</p>               </td>               <td class="code">                 <div class="highlight"><pre><span class="nx">define</span> <span class="p">[</span><span class="s">&#39;jquery&#39;</span><span class="p">,</span> <span class="s">&#39;underscore&#39;</span><span class="p">],</span> <span class="nf">($, _) -&gt;</span></pre></div>               </td>             </tr>                                     <tr id="section-2">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-2">&#182;</a>                 </div>                 <h1>jQuery Core Extension</h1>               </td>               <td class="code">                 <div class="highlight"><pre></pre></div>               </td>             </tr>                                     <tr id="section-3">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-3">&#182;</a>                 </div>                 <p>Customize libraries.
Use mustache templating conventions.</p>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">_.templateSettings = interpolate: </span><span class="sr">/\{\{(.+?)\}\}/g</span></pre></div>               </td>             </tr>                                     <tr id="section-4">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-4">&#182;</a>                 </div>                 <p>Helper accessor that automates css value conversion.</p>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">$.fn.cssNum = </span><span class="nf">(prop) -&gt;</span>
    <span class="nv">val = </span><span class="nx">@</span><span class="p">.</span><span class="nx">css</span> <span class="nx">prop</span>
    <span class="k">if</span> <span class="nx">prop</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">then</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="k">else</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span></pre></div>               </td>             </tr>                                     <tr id="section-5">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-5">&#182;</a>                 </div>                 <p>Private debug flag.</p>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">debug = </span><span class="kc">off</span></pre></div>               </td>             </tr>                                     <tr id="section-6">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-6">&#182;</a>                 </div>                 <p>Besides being a namespace, does two things:</p>

<ol>
<li>Create plugin functions with helpers to maintain convention and debug.</li>
<li>Manage debugging through a custom logger.</li>
</ol>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">NS =</span></pre></div>               </td>             </tr>                                     <tr id="section-7">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-7">&#182;</a>                 </div>                 <p>Create a plugin with event and data name translators that allow the plugin
to follow conventions without being verbose. The helpers are attached as
'private' methods. The logging namespace is the first value logged in each
call. The plugin created has an api instance stored as jQuery data,
accessible via the conventional repeated call, and has the option to be a
singleton and attached to a context element while representing an element
collection. Plugins should follow a set of conventions:</p>

<ul>
<li>Create a subnamespace with <code>debug</code> bool, <code>toString</code> function, <code>defaults</code>
options bag.</li>
<li>Create a private class.</li>
<li>Pass the above two objects to get the plugin and assign it.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="nv">createPlugin: </span><span class="nf">(ns, apiClass, asSingleton=no) -&gt;</span>
      <span class="nv">ns.apiClass = </span><span class="nx">apiClass</span>
      <span class="nv">nsEvt = </span><span class="nx">ns</span><span class="p">.</span><span class="nx">toString</span> <span class="s">&#39;event&#39;</span>
      <span class="nv">nsDat = </span><span class="nx">ns</span><span class="p">.</span><span class="nx">toString</span> <span class="s">&#39;data&#39;</span>
      <span class="nv">nsLog = </span><span class="nx">ns</span><span class="p">.</span><span class="nx">toString</span> <span class="s">&#39;log&#39;</span>
      <span class="k">return</span> <span class="nf">(opt, $ctx) -&gt;</span>
        <span class="nv">$el = </span><span class="kc">null</span> <span class="c1"># Set to right scope.</span>
        <span class="nv">boilerplate = </span><span class="o">-&gt;</span>
          <span class="nv">$root = </span><span class="k">if</span> <span class="nx">asSingleton</span> <span class="o">is</span> <span class="kc">no</span> <span class="k">then</span> <span class="nx">$el</span> <span class="k">else</span> <span class="nx">$ctx</span>
          <span class="nx">$root</span><span class="p">.</span><span class="nx">addClass</span> <span class="nx">ns</span><span class="p">.</span><span class="nx">toString</span> <span class="s">&#39;class&#39;</span>
          <span class="nx">apiClass</span><span class="o">::</span><span class="nx">_evt</span> <span class="o">?=</span> <span class="nf">(name) -&gt;</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">name</span><span class="si">}#{</span><span class="nx">nsEvt</span><span class="si">}</span><span class="s">&quot;</span>
          <span class="nx">apiClass</span><span class="o">::</span><span class="nx">_dat</span> <span class="o">?=</span> <span class="nf">(name) -&gt;</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">nsDat</span><span class="si">}#{</span><span class="nx">name</span><span class="si">}</span><span class="s">&quot;</span>
          <span class="k">if</span> <span class="nx">ns</span><span class="p">.</span><span class="nx">debug</span> <span class="o">is</span> <span class="kc">on</span>
            <span class="nx">apiClass</span><span class="o">::</span><span class="nx">_log</span> <span class="o">?=</span> <span class="o">-&gt;</span>
              <span class="nv">vals = </span><span class="nx">_</span><span class="p">.</span><span class="nx">toArray</span> <span class="nx">arguments</span>
              <span class="nx">vals</span><span class="p">.</span><span class="nx">unshift</span> <span class="nx">nsLog</span>
              <span class="nx">$</span><span class="p">.</span><span class="nx">hlf</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">apply</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">vals</span>

          <span class="k">else</span> <span class="nx">apiClass</span><span class="o">::</span><span class="nx">_log</span> <span class="o">?=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">noop</span>
          <span class="nx">$root</span><span class="p">.</span><span class="nx">data</span> <span class="nx">ns</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span> <span class="k">new</span> <span class="nx">apiClass</span> <span class="nx">$el</span><span class="p">,</span> <span class="nx">opt</span><span class="p">,</span> <span class="nx">$ctx</span>

        <span class="nx">$ctx</span> <span class="o">?=</span> <span class="nx">$</span> <span class="s">&#39;body&#39;</span></pre></div>               </td>             </tr>                                     <tr id="section-8">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-8">&#182;</a>                 </div>                 <ul>
<li>Try returning existing plugin api if no options are passed in.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>        <span class="nv">api = </span><span class="nx">@first</span><span class="p">().</span><span class="nx">data</span> <span class="nx">ns</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span>
        <span class="k">return</span> <span class="nx">api</span> <span class="k">if</span> <span class="nx">api</span><span class="o">?</span> <span class="o">and</span> <span class="o">not</span> <span class="nx">opt</span><span class="o">?</span></pre></div>               </td>             </tr>                                     <tr id="section-9">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-9">&#182;</a>                 </div>                 <ul>
<li>Re-apply plugin.</li>
</ul>               </td>               <td class="code">                 <div class="highlight"><pre>        <span class="nv">opt = </span><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span> <span class="p">(</span><span class="nx">deep</span><span class="o">=</span><span class="kc">on</span><span class="p">),</span> <span class="p">{},</span> <span class="nx">ns</span><span class="p">.</span><span class="nx">defaults</span><span class="p">,</span> <span class="nx">opt</span>

        <span class="k">if</span> <span class="nx">asSingleton</span> <span class="o">is</span> <span class="kc">no</span>
          <span class="k">return</span> <span class="nx">@each</span> <span class="o">-&gt;</span>
            <span class="nv">$el = </span><span class="nx">$</span> <span class="nx">@</span>
            <span class="nx">boilerplate</span><span class="p">()</span>

        <span class="k">else</span>
          <span class="nv">$el = </span><span class="nx">@</span>
          <span class="nx">boilerplate</span><span class="p">()</span></pre></div>               </td>             </tr>                                     <tr id="section-10">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-10">&#182;</a>                 </div>                 <p>Call to turn off when going to production.</p>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="nv">debug: </span><span class="nf">(val) -&gt;</span>
      <span class="k">if</span> <span class="nx">val</span><span class="o">?</span>
        <span class="nv">debug = </span><span class="o">!!</span><span class="nx">val</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&#39;body&#39;</span><span class="p">).</span><span class="nx">trigger</span> <span class="s">&quot;debug</span><span class="si">#{</span><span class="nx">@</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="s">&#39;event&#39;</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="nx">debug</span></pre></div>               </td>             </tr>                                     <tr id="section-11">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-11">&#182;</a>                 </div>                 <p>This is a template for <code>toString</code> functions for sub-namespaces.</p>               </td>               <td class="code">                 <div class="highlight"><pre>    <span class="nv">toString: </span><span class="nf">(context) -&gt;</span>
      <span class="k">switch</span> <span class="nx">context</span>
        <span class="k">when</span> <span class="s">&#39;event&#39;</span>  <span class="k">then</span> <span class="s">&#39;.hlf&#39;</span>
        <span class="k">when</span> <span class="s">&#39;data&#39;</span>   <span class="k">then</span> <span class="s">&#39;hlf&#39;</span>
        <span class="k">when</span> <span class="s">&#39;log&#39;</span>    <span class="k">then</span> <span class="s">&#39;hlf:&#39;</span>
        <span class="k">else</span> <span class="s">&#39;hlf&#39;</span>

  <span class="nv">makeLog = </span><span class="o">-&gt;</span> <span class="p">(</span><span class="k">if</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">bind</span> <span class="k">then</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">console</span><span class="p">)</span> <span class="k">else</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">)</span></pre></div>               </td>             </tr>                                     <tr id="section-12">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-12">&#182;</a>                 </div>                 <p>Don't setup a logger if we're not debugging.</p>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">NS.log = </span><span class="k">if</span> <span class="nx">NS</span><span class="p">.</span><span class="nx">debug</span><span class="p">()</span> <span class="o">is</span> <span class="kc">off</span> <span class="k">then</span> <span class="nx">$</span><span class="p">.</span><span class="nx">noop</span> <span class="k">else</span> <span class="nx">makeLog</span><span class="p">()</span></pre></div>               </td>             </tr>                                     <tr id="section-13">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-13">&#182;</a>                 </div>                 <p>But if we change our mind, ie. in the app init code, setup logging.
Also make AMD code easier to debug.</p>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nx">$</span><span class="p">(</span><span class="s">&#39;body&#39;</span><span class="p">).</span><span class="kc">on</span> <span class="s">&quot;debug</span><span class="si">#{</span><span class="nx">NS</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="s">&#39;event&#39;</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="o">-&gt;</span>
    <span class="k">if</span> <span class="nx">debug</span> <span class="o">is</span> <span class="kc">on</span>
      <span class="nb">window</span><span class="p">.</span><span class="nv">$ = </span><span class="nx">$</span>
      <span class="nb">window</span><span class="p">.</span><span class="nv">_ = </span><span class="nx">_</span>
      <span class="nv">NS.log = </span><span class="nx">makeLog</span><span class="p">()</span></pre></div>               </td>             </tr>                                     <tr id="section-14">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-14">&#182;</a>                 </div>                 <p>Export for global jQuery.</p>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="nv">$.hlf = </span><span class="nx">NS</span></pre></div>               </td>             </tr>                                     <tr id="section-15">               <td class="docs">                 <div class="pilwrap">                   <a class="pilcrow" href="#section-15">&#182;</a>                 </div>                 <p>Export for AMD.</p>               </td>               <td class="code">                 <div class="highlight"><pre>  <span class="k">return</span> <span class="nx">NS</span>

</pre></div>               </td>             </tr>                    </tbody>       </table>     </div>   </div>   <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>   <script src="docco-client.js"></script>        <script>       docco = window.docco || {};       docco.no_results_tpl = function(vars){         vars.msg = vars.msg || 'No results.';         return '<div class="menu-item no-results">'+vars.msg+'</div>';        };       docco.sticky_item_tpl = function(vars){         if (!vars.path || !vars.href) { return; }         return '<a class="source sticky" href="'+vars.href+'"'+             'title="'+vars.path+'" data-path="'+vars.path+'">'+             vars.path.split('/').pop().split('.').shift()+             '<span class="remove" title="Remove sticky">x</span>'+           '</a>';       };     </script>    </body> </html> 